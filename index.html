<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weer, Tijd en Datum</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      background: #e9f0ff;
    }
    .container {
      background: #fff;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      width: 360px;
      max-width: 90%;
    }
    .datetime {
      text-align: center;
      margin-bottom: 15px;
    }
    #time {
      font-size: 1.8rem;
      font-weight: bold;
    }
    #date {
      color: #666;
    }
    .weather-card {
      display: flex;
      align-items: center;
      gap: 15px;
      background: #f0f4ff;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 15px;
    }
    #weatherIcon img {
      width: 60px;
      height: 60px;
    }
    .weather-info {
      flex: 1;
    }
    .weather-info .temp {
      font-size: 1.4rem;
      font-weight: bold;
    }
    .weather-info .desc {
      color: #666;
      text-transform: capitalize;
    }
    .controls {
      display: flex;
      gap: 8px;
      margin-bottom: 10px;
    }
    input[type="text"] {
      flex: 1;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      outline: none;
    }
    button {
      padding: 8px 12px;
      border-radius: 8px;
      border: none;
      background: #2b8cff;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover {
      background: #1f6ed8;
    }
    .meta {
      display: flex;
      justify-content: space-between;
      font-size: 0.9rem;
      color: #666;
    }
    .error {
      color: red;
      text-align: center;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="datetime">
      <div id="time">--:--:--</div>
      <div id="date">Laden...</div>
    </div>

    <div class="weather-card">
      <div id="weatherIcon">‚òÅÔ∏è</div>
      <div class="weather-info">
        <div id="location">Locatie</div>
        <div class="temp" id="temp">--¬∞C</div>
        <div class="desc" id="desc">--</div>
      </div>
    </div>

    <div class="error" id="errorMsg"></div>

    <div class="controls">
      <input type="text" id="cityInput" placeholder="Voer stad in">
      <button id="searchBtn">Zoek</button>
      <button id="locBtn" title="Gebruik mijn locatie">üìç</button>
    </div>

    <div class="meta">
      <div id="lastUpdated">Niet bijgewerkt</div>
      <div id="wind">Wind: --</div>
    </div>
  </div>

  <script>
    const API_KEY = '50dc6a131a56d1bc3713827427110094';

    // DOM elementen
    const timeEl = document.getElementById('time');
    const dateEl = document.getElementById('date');
    const tempEl = document.getElementById('temp');
    const descEl = document.getElementById('desc');
    const locationEl = document.getElementById('location');
    const weatherIconEl = document.getElementById('weatherIcon');
    const lastEl = document.getElementById('lastUpdated');
    const windEl = document.getElementById('wind');
    const errorEl = document.getElementById('errorMsg');
    const cityInput = document.getElementById('cityInput');

    // Klok en datum
    function updateClock(){
      const now = new Date();
      timeEl.textContent = now.toLocaleTimeString('nl-NL');
      dateEl.textContent = now.toLocaleDateString('nl-NL', {weekday:'long', year:'numeric', month:'long', day:'numeric'});
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Weer tonen
    function showWeather(data){
      if(!data) return;
      errorEl.textContent = '';
      const tempC = Math.round(data.main.temp);
      tempEl.textContent = `${tempC}¬∞C`;
      descEl.textContent = data.weather[0].description;
      locationEl.textContent = `${data.name}, ${data.sys.country}`;
      windEl.textContent = `Wind: ${data.wind.speed} m/s`;
      lastEl.textContent = `Bijgewerkt: ${new Date().toLocaleTimeString('nl-NL')}`;
      const icon = data.weather[0].icon;
      weatherIconEl.innerHTML = `<img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="${data.weather[0].description}">`;
    }

    // Fetch via stad
    async function fetchWeatherByCity(city){
      if(!city) return;
      try{
        const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&units=metric&lang=nl&appid=${API_KEY}`;
        const res = await fetch(url);
        if(!res.ok){
          if(res.status === 404){
            errorEl.textContent = 'Stad niet gevonden! Controleer spelling of voeg landcode toe (bv. Amsterdam,nl)';
          } else if(res.status === 401){
            errorEl.textContent = 'Ongeldige API key!';
          } else {
            errorEl.textContent = 'Fout bij ophalen weer.';
          }
          return;
        }
        const data = await res.json();
        showWeather(data);
      } catch(err){
        errorEl.textContent = 'Er is een fout opgetreden bij het ophalen van het weer.';
        console.error(err);
      }
    }

    // Fetch via locatie
    function fetchWeatherByCoords(lat, lon){
      const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=nl&appid=${API_KEY}`;
      fetch(url)
        .then(res => {
          if(!res.ok) throw new Error('Geen data');
          return res.json();
        })
        .then(data => showWeather(data))
        .catch(err => {
          errorEl.textContent = 'Kon locatieweer niet ophalen.';
          console.error(err);
        });
    }

    // Event listeners
    document.getElementById('searchBtn').addEventListener('click', () => {
      const city = cityInput.value.trim();
      if(city) fetchWeatherByCity(city);
    });

    cityInput.addEventListener('keydown', (e) => {
      if(e.key === 'Enter') document.getElementById('searchBtn').click();
    });

    document.getElementById('locBtn').addEventListener('click', () => {
      if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(pos => {
          fetchWeatherByCoords(pos.coords.latitude, pos.coords.longitude);
        }, () => {
          errorEl.textContent = 'Locatie geweigerd of niet beschikbaar.';
        });
      } else {
        errorEl.textContent = 'Geolocatie niet ondersteund.';
      }
    });

    // Default: probeer browser-locatie, anders Amsterdam
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(pos => {
        fetchWeatherByCoords(pos.coords.latitude, pos.coords.longitude);
      }, () => {
        fetchWeatherByCity('Amsterdam,nl');
      });
    } else {
      fetchWeatherByCity('Amsterdam,nl');
    }
  </script>
</body>
</html>



